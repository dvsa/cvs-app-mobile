<ion-header>
  <ion-navbar>
    <ion-title margin-left>
      Defect details
    </ion-title>
    <ion-buttons end>
      <button ion-button block color="light" (click)="addDefect()">
        <span>{{ isEdit ? 'Done' : 'Add Defect' }}</span>
      </button>
    </ion-buttons>
  </ion-navbar>
</ion-header>

<ion-content no-padding>
  <ion-list text-wrap>

    <ion-item-group>
      <ion-item-divider text-uppercase>
        <span>Defect item</span>
      </ion-item-divider>
      <ion-grid padding-horizontal>
        <ion-row justify-content-start align-items-center class="defect-status">
          <b padding-right>{{ defect.ref }}</b>
          <ion-badge item-end text-uppercase [color]="defectsService.getBadgeColor(defect.deficiencyCategory)">
            {{ defect.deficiencyCategory }}
          </ion-badge>
          <ion-badge class="badge__prs" item-end text-uppercase color="primary" *ngIf="defect.prs">
            PRS
          </ion-badge>
        </ion-row>
        <ion-row>
          <h6>{{defect.metadata.item.itemDescription}}</h6>
        </ion-row>
        <ion-row class="defect-description">
          <p>{{ defect.deficiencyText }}</p>
        </ion-row>
      </ion-grid>
    </ion-item-group>

    <ion-item-group>
      <ion-item-divider text-uppercase>
        <span>LOCATION</span>
      </ion-item-divider>

      <ion-item *ngIf="defectMetadata.location.vertical.length > 0">
        <ion-label>Vertical</ion-label>
        <ion-select item-end interface="action-sheet" [(ngModel)]="defect.location.vertical" placeholder="Select">
          <ion-option *ngFor="let position of defectMetadata.location.vertical" [value]="position">{{position}}</ion-option>
        </ion-select>
      </ion-item>
      <ion-item *ngIf="defectMetadata.location.horizontal.length > 0">
        <ion-label>Horizontal</ion-label>
        <ion-select item-end interface="action-sheet" [(ngModel)]="defect.location.horizontal" placeholder="Select">
          <ion-option *ngFor="let position of defectMetadata.location.horizontal" [value]="position">{{position}}</ion-option>
        </ion-select>
      </ion-item>
      <ion-item *ngIf="defectMetadata.location.lateral.length > 0">
        <ion-label>Lateral</ion-label>
        <ion-select item-end interface="action-sheet" [(ngModel)]="defect.location.lateral" placeholder="Select">
          <ion-option *ngFor="let position of defectMetadata.location.lateral" [value]="position">{{position}}</ion-option>
        </ion-select>
      </ion-item>
      <ion-item *ngIf="defectMetadata.location.longitudinal.length > 0">
        <ion-label>Longitudinal</ion-label>
        <ion-select item-end interface="action-sheet" [(ngModel)]="defect.location.longitudinal" placeholder="Select">
          <ion-option *ngFor="let position of defectMetadata.location.longitudinal" [value]="position">{{position}}</ion-option>
        </ion-select>
      </ion-item>
      <ion-item *ngIf="defectMetadata.location.rowNumber.length > 0">
        <ion-label>Row Number</ion-label>
        <ion-select item-end interface="action-sheet" [(ngModel)]="defect.location.rowNumber" placeholder="Select">
          <ion-option *ngFor="let position of defectMetadata.location.rowNumber" [value]="position">{{position}}</ion-option>
        </ion-select>
      </ion-item>
      <ion-item *ngIf="defectMetadata.location.seatNumber.length > 0">
        <ion-label>Seat Number</ion-label>
        <ion-select item-end interface="action-sheet" [(ngModel)]="defect.location.seatNumber" placeholder="Select">
          <ion-option *ngFor="let position of defectMetadata.location.seatNumber" [value]="position">{{position}}</ion-option>
        </ion-select>
      </ion-item>
      <ion-item *ngIf="defectMetadata.location.axleNumber.length > 0">
        <ion-label>Axle Number</ion-label>
        <ion-select item-end interface="action-sheet" [(ngModel)]="defect.location.axleNumber" placeholder="Select">
          <ion-option *ngFor="let position of defectMetadata.location.axleNumber" [value]="position">{{position}}</ion-option>
        </ion-select>
      </ion-item>
    </ion-item-group>

    <ion-item-group *ngIf="defectMetadata.notes">
      <ion-item-divider text-uppercase>
        <span>NOTES</span>
      </ion-item-divider>
      <ion-item padding-left>
        <ion-textarea placeholder="Add notes" [(ngModel)]="defect.notes" maxlength="200" class="textarea-height"></ion-textarea>
      </ion-item>
    </ion-item-group>

    <ion-item-group>
      <ion-item-divider text-uppercase>
        <span>PRS</span>
      </ion-item-divider>
      <ion-item no-lines>
        <ion-label>Defect repaired during test</ion-label>
        <ion-toggle color="secondary" checked="false" [(ngModel)]="defect.prs"></ion-toggle>
      </ion-item>
    </ion-item-group>
  </ion-list>

</ion-content>
